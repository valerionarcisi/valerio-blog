---
import AstroLayout from "../layouts/layout.astro";
import Blog from "../components/Blog/Blog";
import type { TPost } from "../models/model";

const query = {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    query: `{
      posts(orderBy: publishedAt_DESC) {
        id,
        title,
        slug,
        publishedAt,
        tags,
        extract
        createdAt
        coverImage {
          id,
          url,
          fileName,
        }
      }
    }
  `,
  }),
};

const response = await fetch(import.meta.env.HYGRAPH_ENDPOINT, query);
const json = await response.json();
const posts: TPost[] = json.data.posts;
---

<AstroLayout>
  <Blog posts={posts} />
</AstroLayout>
